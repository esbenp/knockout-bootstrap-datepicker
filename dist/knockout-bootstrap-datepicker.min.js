!function(e,t){"function"==typeof define&&define.amd?define(["knockout","bootstrap-datepicker","jquery"],t):"object"==typeof exports?module.exports=t(require("knockout"),require("bootstrap-datepicker"),require("jquery")):e.ko=t(e.ko,e.$.fn.Datepicker,e.jQuery)}(this,function(e,t,i){var n=function(t,n,r){this.element=i(t),this.observable=n(),this.settings=this.generateSettings(r()),this.initializeDatepicker(),e.isObservable(this.observable)&&(this.ignoreSubscription=!1,this.setupChangeEvents(),this.setupObservableSubscriber())};n.DEFAULTS={Binding:{defaultViewDate:"today",startDate:null},BootstrapDatepicker:{autoclose:!0,format:"yyyy-mm-dd",weekStart:1}};var r=function(e){return"today"===e?new Date:new Date(e)};return n.prototype.datePickedEvent=function(e){var t=e.date;this.ignoreSubscription=!0,this.setObservable(t),this.ignoreSubscription=!1},n.prototype.generateSettings=function(e){var t=i.extend({},n.DEFAULTS.Binding,e),a=r(t.defaultViewDate);return t.defaultViewDate={year:a.getFullYear(),month:a.getMonth(),day:a.getDate()},t},n.prototype.generateBootstrapDatepickerSettings=function(){var e=i.extend({},n.DEFAULTS.BootstrapDatepicker,this.settings);return e.startDate instanceof Date||(e.startDate=r(e.startDate)),e},n.prototype.initializeDatepicker=function(){var t=this.generateBootstrapDatepickerSettings();this.element.datepicker(t);var i=e.unwrap(this.observable);!i instanceof Date&&(i=new Date(i)),this.updateDatepicker(i)},n.prototype.setObservable=function(e){var t=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate();this.observable(t)},n.prototype.setupChangeEvents=function(){this.element.on("changeDate",this.datePickedEvent.bind(this))},n.prototype.setupObservableSubscriber=function(){var e=this;this.observable.subscribe(function(t){e.ignoreSubscription===!1&&e.updateDatepicker(new Date(t))})},n.prototype.updateDatepicker=function(e){this.element.datepicker("update",e)},e.bindingHandlers.datepicker={},e.bindingHandlers.datepicker.init=function(e,t,i){return new n(e,t,i)},e});